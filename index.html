<!doctype html>
<html>
    <head>
    </head>
    <body>
        <div id="teardown-setup-container"></div>
        <form id="my-form-id" action="/" method="get">
            <label for="bt_version">braintree.js version</label><input id="bt_version" name="bt_version" readonly>
            <div id="paypal-container"></div>
        </form>

        <script src="https://js.braintreegateway.com/js/braintree-2.24.1.min.js"></script>
        <script>
            var btInstance;
            var myform = document.getElementById('my-form-id');
            var lifecycleContainer = document.getElementById('teardown-setup-container');
            var btVersionInput = myform['bt_version'];
            var setupBtn = document.createElement('button');
            var teardownBtn = document.createElement('button');

            btVersionInput.value = braintree.VERSION;

            setupBtn.innerHTML = 'setup braintree.js';
            setupBtn.addEventListener('click', setup);

            teardownBtn.innerHTML = 'teardown braintree.js';
            teardownBtn.addEventListener('click', teardown);

            lifecycleContainer.appendChild(setupBtn);

            function setup () {
                if (btInstance) {
                    alert('braintree is already set up!');
                    return;
                }

                setupBtn.setAttribute('disabled', 'disabled');

                braintree.setup('sandbox_cq2s8rhd_mc7znnmhd2ywv7qv', 'custom', {
                    id: 'my-form-id',
                    paypal: {
                        container: 'paypal-container'
                    },
                    onReady: function (bt) {
                        btInstance = bt;
                        setupBtn.removeAttribute('disabled');
                        lifecycleContainer.removeChild(setupBtn);
                        lifecycleContainer.appendChild(teardownBtn);
                    },
                    onPaymentMethodReceived: function () {},
                    useCreditCard: false
                });
            }

            function teardown () {
                if (!btInstance) {
                    alert('braintree is already torn down!');
                    return;
                }

                teardownBtn.setAttribute('disabled', 'disabled');

                btInstance.teardown(function () {
                    btInstance = null;
                    teardownBtn.removeAttribute('disabled');
                    lifecycleContainer.removeChild(teardownBtn);
                    lifecycleContainer.appendChild(setupBtn);
                });
            }
        </script>
    </body>
</html>
